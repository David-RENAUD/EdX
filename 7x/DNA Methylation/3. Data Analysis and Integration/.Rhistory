(1.16*8.314*300+0.016*100000)/(0.06*100000)
1-.7488787
## PH525 4x HDDA
# SVD eercises
library(tissuesGeneExpression)
data(tissuesGeneExpression)
s = svd(e)
signflips = sample(c(-1,1),ncol(e),replace=TRUE)
signflips
s = svd(e)
m = rowMeans(e)
class(s)
str(s)
str(s$u)
length(m)
cor(m,s$u[,1])
cor(m,s$u[,1])
m <- 100
n <- 2
x <- rnorm(m)
e <- rnorm(n*m,0,0.01)
Y <- cbind(x,x)+e
cor(Y)
str(Y)
str(e)
cor(Y)
rm(list=ls())
path="C:/temp/RSpace/PH525rawdata/PH525tcgaMethylationSubset-master"
list.files(path)
library(minfi)
library(IlluminaHumanMethylation450kmanifest)
library(IlluminaHumanMethylation450kanno.ilmn12.hg19)
#path="/YourPath"
targets=read.delim(file.path (path,"targets.txt"),as.is=TRUE)
nrow(targets)
nrow(targets[targets$Status=="normal" & targets$Tissue=="colon",])
# or
sum(targets$Tissue=="colon" & targets$Status=="normal")
##or look here
table(targets$Tissue,targets$Status)
index = which( targets$Status=="normal" & targets$Tissue%in%c("colon","breast") )
targets = targets[index,]
library(minfi)
dat = read.450k.exp(base=path,targets = targets, verbose=TRUE)
class(dat)
## preprocess the data
dat = preprocessIllumina(dat)
class(dat)
## assign locations to each CpG
dat = mapToGenome(dat)
class(dat)
## precompute methylation values from U and M values
dat = ratioConvert(dat,type="Illumina")
class(dat)
library(rafalib)
mypar(1,1)
##extract methylation values
y = getBeta(dat)
shist(y)
mds = cmdscale( dist(t(y)))
tissue = as.factor(pData(dat)$Tissue)
plot(mds,col=tissue)
library(limma)
##create design matrix
tissue = as.factor(pData(dat)$Tissue)
X = model.matrix(~tissue)
##extract methylation values
y = getBeta(dat)
## obtain effect sizes and pvals with limma
fit = lmFit(y,X)
summary(fit)
fit$coefficients
which.max(summmary$coefficients[2])
which.max(summmary$coefficients[,2])
which.max(fit$coefficients[,2])
class(dat)
dat
pData
summary(fit)
class(targets)
str(targets)
summary(dat)
dat
?ebayes
eb<-ebayes(fit)
eb
str(eb)
maxes<-which.max(fit$coefficients[,2])
maxes
head(dat)
pData(dat)
pData(dat)$rownames
setwd("C:/temp/RSpace/PH525/7x/DNA Methylation/3. Data Analysis and Integration")
path="C:/temp/RSpace/PH525rawdata/PH525tcgaMethylationSubset-master"
list.files(path)
library(minfi)
library(IlluminaHumanMethylation450kmanifest)
library(IlluminaHumanMethylation450kanno.ilmn12.hg19)
#path="/YourPath"
targets=read.delim(file.path (path,"targets.txt"),as.is=TRUE)
nrow(targets)
nrow(targets[targets$Status=="normal" & targets$Tissue=="colon",])
# or
sum(targets$Tissue=="colon" & targets$Status=="normal")
##or look here
table(targets$Tissue,targets$Status)
index = which( targets$Status=="normal" & targets$Tissue%in%c("colon","breast") )
targets = targets[index,]
library(minfi)
dat = read.450k.exp(base=path,targets = targets, verbose=TRUE)
class(dat)
## preprocess the data
dat = preprocessIllumina(dat)
class(dat)
## assign locations to each CpG
dat = mapToGenome(dat)
class(dat)
## precompute methylation values from U and M values
dat = ratioConvert(dat,type="Illumina")
class(dat)
dat = preprocessIllumina(dat)
dat = read.450k.exp(base=path,targets = targets, verbose=TRUE)
class(dat)
## preprocess the data
dat = preprocessIllumina(dat)
class(dat)
## assign locations to each CpG
dat = mapToGenome(dat)
